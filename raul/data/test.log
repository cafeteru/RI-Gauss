/*C20*/SET SCHEMA PUBLIC
DISCONNECT
/*C21*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TMECANICOS VALUES(1,'Perez','1245','Pepe')
COMMIT
DISCONNECT
/*C22*/SET SCHEMA PUBLIC
DISCONNECT
/*C23*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:54.426000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C24*/SET SCHEMA PUBLIC
DISCONNECT
/*C25*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:55.792000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C26*/SET SCHEMA PUBLIC
DISCONNECT
/*C27*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:56.257000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C28*/SET SCHEMA PUBLIC
DISCONNECT
/*C29*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:56.688000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C30*/SET SCHEMA PUBLIC
DISCONNECT
/*C31*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:57.110000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C32*/SET SCHEMA PUBLIC
DISCONNECT
/*C33*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:57.532000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C34*/SET SCHEMA PUBLIC
DISCONNECT
/*C35*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:57.951000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C36*/SET SCHEMA PUBLIC
DISCONNECT
/*C37*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:58.395000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
/*C38*/SET SCHEMA PUBLIC
DISCONNECT
/*C39*/SET SCHEMA PUBLIC
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_INTERVENCION_ID
ALTER TABLE TSustituciones DROP CONSTRAINT FK_TSustituciones_REPUESTO_ID
ALTER TABLE TSustituciones DROP CONSTRAINT UNQ_TSustituciones_0
ALTER TABLE TMediosPago DROP CONSTRAINT FK_TMediosPago_CLIENTE_ID
ALTER TABLE TMetalicos DROP CONSTRAINT FK_TMetalicos_ID
ALTER TABLE TTarjetasCredito DROP CONSTRAINT FK_TTarjetasCredito_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_FACTURA_ID
ALTER TABLE TCargos DROP CONSTRAINT FK_TCargos_MEDIOPAGO_ID
ALTER TABLE TCargos DROP CONSTRAINT UNQ_TCargos_0
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_AVERIA_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT FK_TIntervenciones_MECANICO_ID
ALTER TABLE TIntervenciones DROP CONSTRAINT UNQ_TIntervenciones_0
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_CLIENTE_ID
ALTER TABLE TVehiculos DROP CONSTRAINT FK_TVehiculos_TIPO_ID
ALTER TABLE TBonos DROP CONSTRAINT FK_TBonos_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_MECANICO_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_FACTURA_ID
ALTER TABLE TAverias DROP CONSTRAINT FK_TAverias_VEHICULO_ID
ALTER TABLE TAverias DROP CONSTRAINT UNQ_TAverias_0
DROP TABLE TSustituciones
DROP TABLE TMediosPago
DROP TABLE TMetalicos
DROP TABLE TTarjetasCredito
DROP TABLE TClientes
DROP TABLE TCargos
DROP TABLE TMecanicos
DROP TABLE TTiposVehiculo
DROP TABLE TIntervenciones
DROP TABLE TRepuestos
DROP TABLE TVehiculos
DROP TABLE TBonos
DROP TABLE TAverias
DROP TABLE TFacturas
CREATE TABLE TSustituciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CANTIDAD INTEGER, INTERVENCION_ID BIGINT, REPUESTO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMediosPago (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DTYPE VARCHAR(31), ACUMULADO REAL, CLIENTE_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMetalicos (ID BIGINT NOT NULL, PRIMARY KEY (ID))
CREATE TABLE TTarjetasCredito (ID BIGINT NOT NULL, NUMERO VARCHAR(255), TIPO VARCHAR(255), VALIDEZ TIMESTAMP, PRIMARY KEY (ID))
CREATE TABLE TClientes (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), CITY VARCHAR(255), STREET VARCHAR(255), ZIPCODE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TCargos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, IMPORTE REAL, FACTURA_ID BIGINT, MEDIOPAGO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TMecanicos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, APELLIDOS VARCHAR(255), DNI VARCHAR(255), NOMBRE VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE TTiposVehiculo (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, NOMBRE VARCHAR(255), PRECIOHORA REAL, PRIMARY KEY (ID))
CREATE TABLE TIntervenciones (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MINUTOS INTEGER, AVERIA_ID BIGINT, MECANICO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TRepuestos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), PRECIO REAL, PRIMARY KEY (ID))
CREATE TABLE TVehiculos (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, MARCA VARCHAR(255), MATRICULA VARCHAR(255), MODELO VARCHAR(255), num_averias INTEGER, CLIENTE_ID BIGINT, TIPO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TBonos (ID BIGINT NOT NULL, CODIGO VARCHAR(255), DESCRIPCION VARCHAR(255), DISPONIBLE REAL, PRIMARY KEY (ID))
CREATE TABLE TAverias (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, DESCRIPCION VARCHAR(255), FECHA TIMESTAMP, IMPORTE REAL, STATUS VARCHAR(255), USADA_BONO BOOLEAN, FACTURA_ID BIGINT, MECANICO_ID BIGINT, VEHICULO_ID BIGINT, PRIMARY KEY (ID))
CREATE TABLE TFacturas (ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL, FECHA TIMESTAMP, IMPORTE REAL, IVA REAL, NUMERO BIGINT, STATUS VARCHAR(255), USADA_BONO BOOLEAN, PRIMARY KEY (ID))
ALTER TABLE TSustituciones ADD CONSTRAINT UNQ_TSustituciones_0 UNIQUE (REPUESTO_ID,INTERVENCION_ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT UNQ_TTarjetasCredito_1 UNIQUE (NUMERO)
ALTER TABLE TClientes ADD CONSTRAINT UNQ_TClientes_2 UNIQUE (DNI)
ALTER TABLE TCargos ADD CONSTRAINT UNQ_TCargos_0 UNIQUE (FACTURA_ID, MEDIOPAGO_ID)
ALTER TABLE TMecanicos ADD CONSTRAINT UNQ_TMecanicos_2 UNIQUE (DNI)
ALTER TABLE TTiposVehiculo ADD CONSTRAINT UNQ_TTiposVehiculo_1 UNIQUE (NOMBRE)
ALTER TABLE TIntervenciones ADD CONSTRAINT UNQ_TIntervenciones_0 UNIQUE (AVERIA_ID, MECANICO_ID)
ALTER TABLE TRepuestos ADD CONSTRAINT UNQ_TRepuestos_1 UNIQUE (CODIGO)
ALTER TABLE TVehiculos ADD CONSTRAINT UNQ_TVehiculos_2 UNIQUE (MATRICULA)
ALTER TABLE TBonos ADD CONSTRAINT UNQ_TBonos_1 UNIQUE (CODIGO)
ALTER TABLE TAverias ADD CONSTRAINT UNQ_TAverias_0 UNIQUE (FECHA, VEHICULO_ID)
ALTER TABLE TFacturas ADD CONSTRAINT UNQ_TFacturas_4 UNIQUE (NUMERO)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_INTERVENCION_ID FOREIGN KEY (INTERVENCION_ID) REFERENCES TIntervenciones (ID)
ALTER TABLE TSustituciones ADD CONSTRAINT FK_TSustituciones_REPUESTO_ID FOREIGN KEY (REPUESTO_ID) REFERENCES TRepuestos (ID)
ALTER TABLE TMediosPago ADD CONSTRAINT FK_TMediosPago_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TMetalicos ADD CONSTRAINT FK_TMetalicos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TTarjetasCredito ADD CONSTRAINT FK_TTarjetasCredito_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TCargos ADD CONSTRAINT FK_TCargos_MEDIOPAGO_ID FOREIGN KEY (MEDIOPAGO_ID) REFERENCES TMediosPago (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_AVERIA_ID FOREIGN KEY (AVERIA_ID) REFERENCES TAverias (ID)
ALTER TABLE TIntervenciones ADD CONSTRAINT FK_TIntervenciones_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_CLIENTE_ID FOREIGN KEY (CLIENTE_ID) REFERENCES TClientes (ID)
ALTER TABLE TVehiculos ADD CONSTRAINT FK_TVehiculos_TIPO_ID FOREIGN KEY (TIPO_ID) REFERENCES TTiposVehiculo (ID)
ALTER TABLE TBonos ADD CONSTRAINT FK_TBonos_ID FOREIGN KEY (ID) REFERENCES TMediosPago (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_MECANICO_ID FOREIGN KEY (MECANICO_ID) REFERENCES TMecanicos (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_FACTURA_ID FOREIGN KEY (FACTURA_ID) REFERENCES TFacturas (ID)
ALTER TABLE TAverias ADD CONSTRAINT FK_TAverias_VEHICULO_ID FOREIGN KEY (VEHICULO_ID) REFERENCES TVehiculos (ID)
INSERT INTO TFACTURAS VALUES(1,'2017-12-13 00:00:00.000000',302.5E0,0.21E0,1,'SIN_ABONAR',FALSE)
INSERT INTO TMECANICOS VALUES(1,'apellidos','dni-mecanico','nombre')
INSERT INTO TCLIENTES VALUES(1,'apellidos','dni','nombre','city','street','zipcode')
INSERT INTO TTIPOSVEHICULO VALUES(1,'coche',50.0E0)
INSERT INTO TVEHICULOS VALUES(1,'seat','1234 GJI','ibiza',0,1,1)
INSERT INTO TAVERIAS VALUES(1,'falla la junta la trocla','2017-12-13 21:10:58.803000',250.0E0,'FACTURADA',FALSE,1,NULL,1)
INSERT INTO TMEDIOSPAGO VALUES(1,'Bono',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(2,'Metalico',0.0E0,1)
INSERT INTO TMEDIOSPAGO VALUES(3,'TarjetaCredito',302.5E0,1)
INSERT INTO TCARGOS VALUES(1,302.5E0,1,3)
INSERT INTO TINTERVENCIONES VALUES(1,60,1,1)
INSERT INTO TREPUESTOS VALUES(1,'R1001','junta la trocla',100.0E0)
INSERT INTO TSUSTITUCIONES VALUES(1,2,1,1)
INSERT INTO TBONOS VALUES(1,'B-100','Voucher just for testing',100.0E0)
INSERT INTO TMETALICOS VALUES(2)
INSERT INTO TTARJETASCREDITO VALUES(3,'1234567','Visa','2018-12-13 00:00:00.000000')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE ID=1
DELETE FROM TREPUESTOS WHERE ID=1
DELETE FROM TINTERVENCIONES WHERE ID=1
DELETE FROM TCARGOS WHERE ID=1
DELETE FROM TTARJETASCREDITO WHERE ID=3
DELETE FROM TMEDIOSPAGO WHERE ID=3
DELETE FROM TMETALICOS WHERE ID=2
DELETE FROM TMEDIOSPAGO WHERE ID=2
DELETE FROM TBONOS WHERE ID=1
DELETE FROM TMEDIOSPAGO WHERE ID=1
DELETE FROM TAVERIAS WHERE ID=1
DELETE FROM TVEHICULOS WHERE ID=1
DELETE FROM TTIPOSVEHICULO WHERE ID=1
DELETE FROM TCLIENTES WHERE ID=1
DELETE FROM TMECANICOS WHERE ID=1
DELETE FROM TFACTURAS WHERE ID=1
COMMIT
DISCONNECT
